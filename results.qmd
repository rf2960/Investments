# Results
```{r}
library(tidyverse)
library(janitor)
library(lubridate)
library(scales)
library(GGally)
library(ggalluvial)

# Bigger, easy-to-read base font for all plots
theme_set(theme_minimal(base_size = 14))
```

```{r}
status_palette <- c(
  operating = "#4C72B0",
  acquired  = "#55A868",
  closed    = "#C44E52",
  ipo       = "#8172B2"
)
```

```{r}
library(tidyverse)
library(janitor)
library(naniar)

startup_raw <- read_csv(
  "investments_VC.csv",
  locale = locale(encoding = "ISO-8859-1")   # matches examples
)

startup <- startup_raw |>
  clean_names() |>                        # makes names snake_case, trims spaces
  select(-starts_with("unnamed_")) |>     # drop completely empty columns
  distinct()                               # remove exact duplicates if any
```

Across the dataset, most startups remain operating, while acquisition and closure outcomes are relatively rare and accumulate over time. Funding intensity and industry context are strongly associated with outcomes, with older cohorts and heavily funded startups more likely to experience exits. These patterns suggest that time, fundraising depth, and market segment jointly shape startup trajectories.

```{r}
status_counts <- startup |> 
  count(status)

gg_status_counts <- ggplot(
  status_counts,
  aes(x = status, y = n, fill = status)
) +
  geom_col() +
  scale_fill_manual(values = status_palette) +
  scale_y_continuous(
    labels = label_number(scale_cut = cut_si(""), accuracy = 1)
  ) +
  labs(
    title    = "Most Startups in the Sample Are Still Operating",
    subtitle = "Count of startups by current Crunchbase status",
    x = NULL,
    y = "Number of startups"
  ) +
  theme(
    plot.title   = element_text(face = "bold", size = 15),
    plot.subtitle= element_text(size = 12),
    legend.position = "none"   # optional but clean here
  )

gg_status_counts
```

Operating startups dominate the dataset, reflecting both the prevalence of ongoing firms and the fact that many startups have not yet reached an exit outcome.


```{r}
gg_funding_status <- startup |>
  filter(funding_total_usd > 0, !is.na(status)) |>
  ggplot(aes(x = status, y = funding_total_usd, fill = status)) +
  geom_boxplot(
    color = "black",
    outlier.alpha = 0.3
  ) +
  scale_fill_manual(values = status_palette) +
  scale_y_log10(
    labels = scales::label_number(
      prefix = "$",
      scale_cut = cut_si(""),
      accuracy = 1
    ),
    breaks = c(1e5, 1e6, 1e7, 1e8, 1e9)
  ) +
  labs(
    title    = "Acquired Startups Tend to Raise More Money",
    subtitle = "Distribution of total funding by status (log scale)",
    x = NULL,
    y = "Total funding (USD, log scale)"
  ) +
  theme(
    plot.title    = element_text(face = "bold", size = 15),
    plot.subtitle = element_text(size = 12),
    legend.position = "none"   # clean, since x already shows status
  )

gg_funding_status
```

Acquired startups tend to raise substantially more total funding than closed firms, while operating startups fall in between, with all three groups exhibiting wide variation in funding levels.

```{r}
top_markets <- startup |>
  count(market, sort = TRUE) |>
  slice_head(n = 15)

gg_top_markets <- ggplot(
  top_markets,
  aes(x = fct_reorder(market, n), y = n)
) +
  geom_col(
    fill  = "#4C72B0",
    alpha = 0.9,
    width = 0.75
  ) +
  coord_flip() +
  scale_y_continuous(
    labels = label_number(
      scale_cut = cut_si(""),
      accuracy  = 1
    ),
    expand = expansion(mult = c(0, 0.05))
  ) +
  labs(
    title    = "Software and Biotech Dominate the Dataset",
    subtitle = "Top 15 markets by number of startups",
    x = NULL,
    y = "Number of startups"
  ) +
  theme(
    plot.title    = element_text(face = "bold", size = 15),
    plot.subtitle = element_text(size = 12),
    axis.text.y   = element_text(size = 11),
    axis.text.x   = element_text(size = 10),
    panel.grid.major.y = element_blank(),
    panel.grid.minor   = element_blank()
  )

gg_top_markets
```

The dominance of software and biotechnology reflects both the scalability of digital products and strong investor interest in technology-driven sectors.

```{r}
top_market_names <- top_markets$market

gg_market_status <- startup |>
  filter(market %in% top_market_names) |>
  count(market, status) |>
  group_by(market) |>
  mutate(prop = n / sum(n)) |>
  ggplot(
    aes(
      x    = fct_reorder(market, prop),
      y    = prop,
      fill = status
    )
  ) +
  geom_col(width = 0.8) +
  coord_flip() +
  scale_fill_manual(values = status_palette) +
  scale_y_continuous(
    labels = label_percent(accuracy = 1),
    expand = expansion(mult = c(0, 0.02))
  ) +
  labs(
    title    = "Most Markets Are Dominated by Operating Startups",
    subtitle = "Within each of the top 15 markets, share of startups by status",
    x = NULL,
    y = "Share of startups"
  ) +
  theme(
    plot.title    = element_text(face = "bold", size = 15),
    plot.subtitle = element_text(size = 12),
    legend.title  = element_blank()
  )

gg_market_status
```

Across nearly all major markets, the majority of startups remain operating, reflecting both the long time horizons required for exits and the concentration of younger firms that have not yet reached acquisition or closure.


```{r}
gg_founded_year <- startup |>
  filter(!is.na(founded_year)) |>
  count(founded_year) |>
  ggplot(aes(x = founded_year, y = n)) +
  geom_line(
    linewidth = 1.2,
    color = "#4C72B0"
  ) +
  geom_point(
    size = 2.4,
    color = "#4C72B0"
  ) +
  scale_y_continuous(
    labels = label_number(
      scale_cut = cut_si(""),
      accuracy  = 1
    )
  ) +
  labs(
    title    = "Startup Foundings Accelerated in the Mid-2000s",
    subtitle = "Number of startups founded by year",
    x = "Year founded",
    y = "Number of startups"
  ) +
  theme(
    plot.title    = element_text(face = "bold", size = 15),
    plot.subtitle = element_text(size = 12)
  )

gg_founded_year
```

The sharp rise in startup foundings in the 2000s highlights a structural shift in entrepreneurial activity, though the apparent decline in the most recent years likely reflects data truncation rather than a true drop in formation.

```{r}
gg_founded_status <- startup |>
  filter(!is.na(founded_year)) |>
  count(founded_year, status) |>
  group_by(founded_year) |>
  mutate(prop = n / sum(n)) |>
  ggplot(aes(x = founded_year, y = prop, fill = status)) +
  geom_area(alpha = 0.85, color = "white", linewidth = 0.2) +
  scale_fill_manual(values = status_palette) +
  scale_y_continuous(labels = label_percent(accuracy = 1)) +
  labs(
    title    = "Older Cohorts Have Had More Time to Be Acquired or Close",
    subtitle = "Share of startups with each outcome by founding year",
    x = "Year founded",
    y = "Share of startups"
  ) +
  theme(
    plot.title    = element_text(face = "bold", size = 15),
    plot.subtitle = element_text(size = 12),
    legend.title  = element_blank(),
    legend.position = "bottom"
  )

gg_founded_status
```

Older startup cohorts show higher acquisition and closure rates because they’ve had more time to progress toward an outcome, whereas most recently founded companies remain in operation by default.

```{r}
# Get top 6 markets
top_markets <- startup |>
  count(market, sort = TRUE) |>
  slice_head(n = 6) |>
  pull(market)

# shorten market labels slightly (important)
mosaic_data <- startup |>
  filter(market %in% top_markets) |>
  mutate(
    market = str_replace_all(market, " ", "\n")
  ) |>
  select(market, status)

tbl <- table(mosaic_data$market, mosaic_data$status)

# Increase margins but not excessively
par(mar = c(6, 6, 3, 3))

mosaicplot(
  tbl,
  color = RColorBrewer::brewer.pal(n = ncol(tbl), "Set2"),
  main = "Outcome Mix Varies Across Major Startup Markets",
  xlab = "Market",
  ylab = "Proportion within Each Market",
  las = 1,
  cex.axis = 0.65,   # ✅ smaller tick labels
  cex.lab  = 1.0,   # ✅ axis labels readable
  cex.main = 1.2    # ✅ title not overpowering
)


```

Although most startups remain active across all markets, the balance between successful exits and failures differs notably by industry, reflecting differences in business models, capital needs, and acquisition demand.

```{r}
library(ggalluvial)

startup_alluvial <- startup %>%
  filter(
    !is.na(founded_year),
    !is.na(funding_rounds),
    !is.na(status)
  ) %>%
  mutate(
    status = factor(
      status,
      levels = c("operating", "acquired", "closed", "ipo")
    ),
    
    founded_period = cut(
      founded_year,
      breaks = c(1990, 2000, 2005, 2010, 2015, 2020),
      labels = c("1990–1999", "2000–2004", "2005–2008",
                 "2009–2011", "2012–2014"),
      include.lowest = TRUE,
      right = FALSE
    ),
    
    rounds_bucket = case_when(
      funding_rounds == 0     ~ "0 rounds",
      funding_rounds == 1     ~ "1 round",
      funding_rounds %in% 2:3 ~ "2–3 rounds",
      funding_rounds >= 4     ~ "4+ rounds"
    )
  ) %>%
  drop_na(founded_period, rounds_bucket)

gg_alluvial <- ggplot(
  startup_alluvial,
  aes(
    axis1 = founded_period,
    axis2 = rounds_bucket,
    axis3 = status,
    y     = ..count..
  )
) +
  geom_alluvium(
    aes(fill = status),
    width = 1/10,
    alpha = 0.85
  ) +
  geom_stratum(
    width  = 1/5,
    fill   = "grey92",
    color  = "grey50"
  ) +
  geom_text(
    stat = "stratum",
    aes(
      label = after_stat(stratum),
      y = after_stat(y)
    ),
    vjust = 0.5,
    size  = 3.0,
    color = "grey25"
  ) +
  scale_fill_manual(values = status_palette, drop = FALSE) +
  scale_x_discrete(
    limits = c("Founded period", "Funding rounds", "Final status"),
    expand = c(.10, .05)
  ) +
  labs(
    title    = "Funding Trajectories and Outcomes Differ Across Startup Cohorts",
    subtitle = "Founding period, funding intensity, and final startup status",
    x        = NULL,
    y        = "Number of startups"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title      = element_text(face = "bold", size = 15),
    plot.subtitle   = element_text(size = 12),
    axis.text.y     = element_blank(),
    panel.grid      = element_blank(),
    legend.position = "bottom",
    legend.title    = element_blank()
  )

gg_alluvial

```

This alluvial plot highlights how founding cohorts, funding intensity, and final startup outcomes are closely intertwined. Startups founded in earlier periods are more likely to progress beyond a single funding round and ultimately reach an acquisition or closure, while more recent cohorts overwhelmingly remain operating, reflecting limited time for exits to occur. Across cohorts, startups with only one funding round are much more likely to remain operating or close, whereas those that raise multiple rounds are disproportionately represented among acquisitions. Overall, the figure suggests that funding intensity acts as a key intermediate pathway linking founding period to eventual outcomes, with greater access to capital associated with higher chances of successful exits.

```{r}
startup_facet <- startup |> 
  filter(funding_total_usd > 0, !is.na(funding_rounds), !is.na(status)) |> 
  mutate( rounds_bucket = case_when( 
    funding_rounds == 0 ~ "0 rounds", 
    funding_rounds == 1 ~ "1 round", 
    funding_rounds %in% 2:3 ~ "2–3 rounds", 
    funding_rounds >= 4 ~ "4+ rounds", 
    TRUE ~ NA_character_ ), 
    rounds_bucket = factor( 
      rounds_bucket, 
      levels = c("0 rounds", "1 round", "2–3 rounds", "4+ rounds") 
      ) 
    ) %>% drop_na(rounds_bucket)

gg_facet_funding_rounds <- ggplot(
  startup_facet,
  aes(x = rounds_bucket, y = funding_total_usd, fill = status)
) +
  geom_boxplot(
    width = 0.65,
    color = "grey30",
    outlier.alpha = 0.25
  ) +
  scale_fill_manual(values = status_palette) +
  scale_y_log10(
    labels = label_number(
      prefix    = "$",
      scale_cut = cut_si(""),
      accuracy  = 1
    )
  ) +
  facet_wrap(~ status, ncol = 2) +
  labs(
    title    = "More Funding Rounds Are Associated with Larger Total Investments",
    subtitle = "Distribution of total funding by number of rounds, shown separately by startup outcome",
    x        = "Number of funding rounds",
    y        = "Total funding (USD, log scale)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title      = element_text(face = "bold", size = 12),
    plot.subtitle   = element_text(size = 10),
    strip.text      = element_text(face = "bold", size = 11),
    axis.text.x     = element_text(size = 8),
    axis.text.y     = element_text(size = 8),
    panel.grid.minor = element_blank(),
    legend.position = "none"
  )

gg_facet_funding_rounds
```

Across all startup outcomes, total funding rises systematically with the number of funding rounds, indicating that companies able to raise repeatedly tend to secure substantially larger cumulative investments. This pattern is especially pronounced for acquired startups, which show both higher medians and upper tails as funding rounds increase, consistent with investors doubling down on firms perceived as successful. Closed startups also exhibit increasing funding with additional rounds, suggesting that raising more capital does not guarantee survival. Among operating startups, the wide spread of funding at higher round counts reflects ongoing uncertainty: while some firms continue to scale rapidly, others accumulate moderate funding without yet reaching a clear exit.

```{r}
startup_year_status <- startup |>
  filter(!is.na(founded_year), status != "unknown") |>
  count(status, founded_year)

gg_facet_year_status <- ggplot(
  startup_year_status,
  aes(x = founded_year, y = n, fill = status)
) +
  geom_col(
    alpha = 0.9,
    width = 0.85
  ) +
  scale_fill_manual(values = status_palette) +
  facet_wrap(~ status, ncol = 2, scales = "free_y") +
  labs(
    title    = "Startup Founding Trends Differ Across Outcomes",
    subtitle = "Number of startups founded per year, separated by final status",
    x        = "Year founded",
    y        = "Number of startups"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    plot.title    = element_text(face = "bold", size = 15),
    plot.subtitle = element_text(size = 12),
    axis.text.x   = element_text(angle = 45, hjust = 1, size = 10),
    axis.text.y   = element_text(size = 11),
    strip.text    = element_text(face = "bold", size = 12),
    panel.grid.minor = element_blank(),
    legend.position = "none"
  )

gg_facet_year_status

```

Startup founding activity differs sharply across outcomes and over time. Acquired startups are heavily concentrated in earlier founding years, reflecting the long time horizons required for exits or failure to materialize. In contrast, operating startups are overwhelmingly founded in more recent years, driven by the rapid expansion of entrepreneurial activity in the late 1990s and 2000s. This divergence highlights a key survivorship dynamic in startup data: many newer firms are still classified as operating not because they are more successful, but because they have not yet had sufficient time to exit. Together, these panels emphasize the importance of accounting for cohort effects when comparing startup outcomes.



